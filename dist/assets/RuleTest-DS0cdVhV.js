import{u as j,c as h,r as _,f as C,w as D,b as d,e as s,t as u,j as r,F as A,m as N,g as n,k as p,o as f,x as I,y as L}from"./vendor-CF_RhtoL.js";import{_ as R,u as z,g as B}from"./index-DyqOvabv.js";const P={class:"rule-test-section my-4"},$={class:"text-secondary"},F={class:"row"},V={class:"card-body"},q={class:"jn-con-title card-title"},Q={class:"card-text text-secondary",style:{"font-size":"10pt"}},G=["data-bs-theme"],H=["disabled"],J={key:0},K={key:1,class:"spinner-grow spinner-grow-sm bg-white","aria-hidden":"true"},O={__name:"RuleTest",setup(U){const{t:e}=j(),v=z(),m=h(()=>v.isDarkMode),b=h(()=>v.isMobile),x=h(()=>v.lang),T=()=>({name:e("ruletest.Name"),ip:e("ruletest.StatusWait"),country_code:"",country:e("ruletest.StatusWait")}),l=_(Array.from({length:8},(o,a)=>({id:a+1,url:`ptest-${a+1}.MyIP.NETQ.ME`,...T()}))),y=_([]),g=_(l.value.length),c=_(!1),M=async(o,a)=>{try{const k=(await(await fetch(`https://${a}/cdn-cgi/trace`)).text()).split(`
`),E=k.find(i=>i.startsWith("ip=")),W=k.find(i=>i.startsWith("loc="));if(E){const i=E.split("=")[1];l.value[o].ip=i,y.value=[...y.value,i]}if(W){const i=W.split("=")[1];l.value[o].country_code=i,l.value[o].country=B(i,x.value)}}catch(t){l.value[o].ip=e("ruletest.StatusError"),l.value[o].country_code="",l.value[o].country=e("ruletest.StatusError"),console.error("Error fetching Data:",t)}},S=async(o=!1)=>{c.value=!1,o&&l.value.forEach(t=>{t.ip=e("ruletest.StatusWait"),t.country=e("ruletest.StatusWait"),t.country_code=""});const a=async t=>{if(t<g.value)try{await M(t,l.value[t].url)}catch(w){console.error("Error fetching Data:",w)}finally{a(t+1),t===g.value-1&&(c.value=!0)}};a(0)};return C(()=>{setTimeout(()=>{S()},1e3)}),D(y,()=>{v.updateAllIPs(y.value)},{deep:!0}),(o,a)=>(f(),d("div",null,[s("div",P,[s("div",$,[s("p",null,u(r(e)("ruletest.Note")),1)]),s("div",F,[(f(!0),d(A,null,N(l.value,t=>(f(),d("div",{key:t.id,class:"col-lg-3 col-md-6 col-12 mb-4"},[s("div",{class:n(["card jn-card",{"dark-mode dark-mode-border":m.value,"jn-hover-card":!b.value}])},[s("div",V,[s("p",q,[a[1]||(a[1]=s("i",{class:"bi bi-signpost-split-fill"},null,-1)),p(" "+u(t.name)+" ",1),s("i",{class:n(["bi","bi-"+t.id+"-square"])},null,2),a[2]||(a[2]=p("  "))]),s("p",Q,[a[3]||(a[3]=s("i",{class:"bi bi-hdd-network-fill"},null,-1)),p(" "+u(t.url),1)]),s("p",{class:n(["card-text",{"text-info":t.ip===r(e)("ruletest.StatusWait"),"text-success":t.ip.includes(".")||t.ip.includes(":"),"text-danger":t.ip===r(e)("ruletest.StatusError")}])},[s("i",{class:n(["bi",[t.ip===r(e)("ruletest.StatusWait")?"bi-hourglass-split":"bi-pc-display-horizontal"]])}," ",2),s("span",{class:n({"jn-ip-font":t.ip.length>32})},u(t.ip),3)],2),s("div",{class:n(["alert",{"alert-info":t.country===r(e)("ruletest.StatusWait"),"alert-danger":t.country===r(e)("ruletest.StatusError"),"alert-success":t.country!==r(e)("ruletest.StatusWait")&&t.country!==r(e)("ruletest.StatusError")}]),"data-bs-theme":m.value?"dark":""},[s("i",{class:n(["bi",[t.ip===r(e)("ruletest.StatusWait")||t.ip===r(e)("ruletest.StatusError")?"bi-hourglass-split":"bi-geo-alt-fill"]])},null,2),p(" "+u(r(e)("ruletest.Country"))+": ",1),s("strong",null,u(t.country)+" ",1),I(s("span",{class:n("jn-fl fi fi-"+t.country_code.toLowerCase())},null,2),[[L,t.country_code]])],10,G)])],2)]))),128)),s("div",{class:n(["flex justify-content-center col-12",[b.value?"":"text-center mt-4"]])},[s("button",{class:n(["btn",[c.value?"btn-success":"btn-info",b.value?"w-100":"w-25"]]),disabled:!c.value,onClick:a[0]||(a[0]=t=>S(!0))},[c.value?(f(),d("span",J,[a[4]||(a[4]=s("i",{class:"bi bi-arrow-clockwise"},null,-1)),p(" "+u(r(e)("ruletest.RefreshAll")),1)])):(f(),d("span",K))],10,H)],2)])])]))}},Z=R(O,[["__scopeId","data-v-4598e332"]]);export{Z as default};
